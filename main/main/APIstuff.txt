/*
 *  This sketch demonstrates how to scan WiFi networks.
 *  The API is almost the same as with the WiFi Shield library,
 *  the most obvious difference being the different file you need to include:
 */
#include "WiFi.h"
#include <HTTPClient.h>
const char* ssid = "INSERT SSID HERE";
const char* password = "INSERT WIFI PASSWORD HERE";
void setup()
{
    Serial.begin(115200);

    // Set WiFi to station mode and disconnect from an AP if it was previously connected
    WiFi.mode(WIFI_STA);
    WiFi.begin(ssid, password);
    Serial.print("Connecting to WiFi ..");
    delay(100);

    Serial.println("Setup done");
}

void loop()
{
    while (WiFi.status() != WL_CONNECTED) 
    {
    Serial.println("Connecting....");
    delay(1000);
    }
    
    if ((WiFi.status() == WL_CONNECTED)) 
    { //Check the current connection status
  
      HTTPClient http;
    
      http.begin("https://lichess.org/api/account"); //Specify the URL
      http.addHeader("Authorization", "Bearer REPLACE THIS TEXT WITH AUTHORIZATION TOKEN");
      int httpCode = http.GET();                                        //Make the request
    
      if (httpCode > 0) { //Check for the returning code
    
          String payload = http.getString();
          Serial.println(httpCode);
          Serial.println(payload);
        }
    
      else {
        Serial.println("Error on HTTP request");
      }
    
      http.end(); //Free the resources
    }
  
    delay(10000);
}
